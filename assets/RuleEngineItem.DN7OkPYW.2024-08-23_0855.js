import{b as _}from"./bus.C7soAy4q.2024-08-23_0855.js";import{d as g,B as x,b as k,j as b,A as w,ai as u,o as i,c as d,U as p,O as R,F as B,a8 as T,M as C,T as E}from"./@vue.BRKSBXdb.2024-08-23_0855.js";import{_ as I}from"./plugin-vueexport-helper.DlAUqK2U.2024-08-23_0855.js";import"./mitt.DJ65BbbF.2024-08-23_0855.js";const j={key:0,class:"children"},L={key:1,class:"label"},M=g({__name:"RuleEngineItem",props:{data:{},parent:{},index:{}},setup(h){const a=h,m=x("draw"),l=k();b(()=>{l.value.dataset.id=a.data.id,_.on("update-svg",()=>{if(!a.data.children){const o=y(l.value.querySelector(".el-select"),!0),s=$(l.value.querySelector(".label"));f(o,s,!0)}if(!a.parent)return;const e=a.index===0,t=y(document.querySelector(`[data-id="${a.parent.id}"] .el-select`),e),n=$(l.value);f(t,n,e)})}),w(()=>{_.off("update-svg")});function f(e,t,n){if(n)m.path(`M${e.x} ${e.y} L${t.x} ${t.y}`).stroke({color:"#ccc",width:2,linecap:"round",linejoin:"round"});else{const o=`M${e.x} ${e.y}`,s=`v${t.y-e.y-20}`,r=`Q${e.x+5} ${t.y-5} ${t.x-20} ${t.y}`,c=`L${t.x} ${t.y}`,v=m.path(`${o} ${s} ${r} ${c}`);v.stroke({color:"#ccc",width:2,linecap:"round",linejoin:"round"}),v.fill("none")}}function y(e,t){const n=e.getBoundingClientRect();return t?{x:n.left+n.width,y:n.top+16}:{x:n.left+60,y:n.top+32}}function $(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top+16}}return(e,t)=>{const n=u("el-option"),o=u("el-select"),s=u("RuleEngineItem",!0);return i(),d("div",{ref_key:"itemRef",ref:l,class:"item"},[p(o,{modelValue:e.data.condition,"onUpdate:modelValue":t[0]||(t[0]=r=>e.data.condition=r),style:{width:"75px"}},{default:R(()=>[p(n,{label:"或者",value:"or"}),p(n,{label:"并且",value:"and"})]),_:1},8,["modelValue"]),e.data.children?(i(),d("div",j,[(i(!0),d(B,null,T(e.data.children,(r,c)=>(i(),C(s,{key:c,data:r,parent:e.data,index:c},null,8,["data","parent","index"]))),128))])):(i(),d("div",L,E(e.data.label),1))],512)}}}),P=I(M,[["__scopeId","data-v-ed87f90c"]]);export{P as default};

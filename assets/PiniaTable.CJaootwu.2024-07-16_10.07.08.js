import{f as X}from"./dateUtils.BVoN4XMW.2024-07-16_10.07.08.js";import{_ as Se}from"./AddMarketing.vuevuetypescriptsetuptruelang.CyOH6gdt.2024-07-16_10.07.08.js";import{_ as Me}from"./EditMarketing.vuevuetypescriptsetuptruelang.AjJiMjZK.2024-07-16_10.07.08.js";import{A as Ue}from"./AutoTooltip.DfrOaXAQ.2024-07-16_10.07.08.js";import{d as A,a5 as $e,a6 as Re,r as p,a as o,o as D,b as M,w as l,e,u as t,l as Y,I as E,M as ee,Z as h,Y as U,L as le,n as te,H as Z,a7 as G,X as x,N as oe,a8 as Ye,a9 as Te,C as ne,D as ae,$ as je,a3 as Q}from"./index.CrWuBC7G.2024-07-16_10.07.08.js";import{d as ze,s as se,u as Fe}from"./index.BU0ptGjF.2024-07-16_10.07.08.js";import{l as Ne,r as Oe}from"./apiFactory.Cvgi4xdT.2024-07-16_10.07.08.js";import{_ as re}from"./plugin-vueexport-helper.DlAUqK2U.2024-07-16_10.07.08.js";import{b as J}from"./bus.CdlF-dbX.2024-07-16_10.07.08.js";import{a as Ie}from"./marketingApi.lWpp_Tvl.2024-07-16_10.07.08.js";const W=A({__name:"MultiSelect",props:$e({options:{},placeholder:{}},{modelValue:{default:[]},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const g=Re(b,"modelValue"),n=b,m=p(!1),s=p([]);function _(r){let f=[];r&&(f=n.options.map(i=>i.value)),g.value=[...f],s.value=[...f]}async function k(){s.value=[...g.value],await te(),m.value=g.value.length===n.options.length}return(r,f)=>{const i=o("el-checkbox"),d=o("el-text"),c=o("el-option"),C=o("el-checkbox-group"),$=o("el-select");return D(),M($,{multiple:"",modelValue:g.value,"onUpdate:modelValue":f[2]||(f[2]=y=>g.value=y),placeholder:r.placeholder,onChange:k},{default:l(()=>[e(i,{label:"全选",modelValue:t(m),"onUpdate:modelValue":f[0]||(f[0]=y=>Y(m)?m.value=y:null),onChange:_,style:{"padding-left":"20px",width:"calc(100% - 20px)"}},null,8,["modelValue"]),e(C,{modelValue:t(s),"onUpdate:modelValue":f[1]||(f[1]=y=>Y(s)?s.value=y:null)},{default:l(()=>[(D(!0),E(le,null,ee(r.options,y=>(D(),M(c,{key:y.value,label:y.label,value:y.value},{default:l(()=>[e(i,{value:y.value,style:{width:"100%"}},{default:l(()=>[e(d,{truncated:""},{default:l(()=>[h(U(y.label),1)]),_:2},1024)]),_:2},1032,["value"])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])}}}),I=ze("marketingTable",()=>{const b=p([]),g=p(0),n=p(10),m=p(1),s=p(),_=p({}),k=p({name:"",beginDate:"",endDate:"",region:[],jit:[]});async function r(){const i=f(),d=await Ne(i),{list:c,pageInfo:C}=d.data;b.value=c,g.value=C.total}function f(){const i={};return i.pageSize=n.value,i.pageNumber=m.value,s.value&&(i.orderBy=s.value),["name","beginDate","endDate","jit","region"].forEach(c=>{const C=k.value[c];C!==""&&(i[c]=C)}),_.value&&Object.assign(i,_.value),i}return{tableData:b,total:g,form:k,pageSize:n,currentPage:m,orderBy:s,filters:_,getTableData:r}}),Ae=b=>(ne("data-v-45e405e8"),b=b(),ae(),b),Pe={style:{display:"flex",width:"100%"}},Be=Ae(()=>x("div",{style:{flex:"1"}},null,-1)),Je=A({__name:"SearchForm",setup(b){const{getTableData:g}=I(),{form:n}=se(I()),m=p(),s=p(!0);function _(k){k.resetFields(),n.value.jit=[],n.value.region=[],g()}return(k,r)=>{const f=o("el-input"),i=o("el-form-item"),d=o("el-col"),c=o("el-date-picker"),C=o("el-button"),$=o("el-icon"),y=o("el-link"),T=o("el-row"),j=o("el-form"),z=o("el-card");return D(),M(z,null,{default:l(()=>[e(j,{ref_key:"formRef",ref:m,model:t(n),inline:!0,"label-width":"auto"},{default:l(()=>[e(T,{gutter:20},{default:l(()=>[e(d,{span:6},{default:l(()=>[e(i,{label:"活动名称",prop:"name"},{default:l(()=>[e(f,{modelValue:t(n).name,"onUpdate:modelValue":r[0]||(r[0]=w=>t(n).name=w),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:l(()=>[e(i,{label:"开始时间",prop:"beginDate"},{default:l(()=>[e(c,{placeholder:"开始时间",modelValue:t(n).beginDate,"onUpdate:modelValue":r[1]||(r[1]=w=>t(n).beginDate=w),type:"date","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:l(()=>[e(i,{label:"结束时间",prop:"endDate"},{default:l(()=>[e(c,{placeholder:"结束时间",modelValue:t(n).endDate,"onUpdate:modelValue":r[2]||(r[2]=w=>t(n).endDate=w),type:"date","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),Z(e(d,{span:6},{default:l(()=>[e(i,{label:"活动区域",prop:"region"},{default:l(()=>[e(W,{modelValue:t(n).region,"onUpdate:modelValue":r[3]||(r[3]=w=>t(n).region=w),placeholder:"请选择活动区域",options:[{label:"区域一",value:"shanghai"},{label:"区域二",value:"beijing"}]},null,8,["modelValue"])]),_:1})]),_:1},512),[[G,!t(s)]]),Z(e(d,{span:6},{default:l(()=>[e(i,{label:"即时配送",prop:"region"},{default:l(()=>[e(W,{modelValue:t(n).jit,"onUpdate:modelValue":r[4]||(r[4]=w=>t(n).jit=w),placeholder:"请选择配送方式",options:[{label:"是",value:1},{label:"否",value:0}]},null,8,["modelValue"])]),_:1})]),_:1},512),[[G,!t(s)]]),e(d,{span:6,style:{"margin-left":"auto","margin-bottom":"0px"}},{default:l(()=>[e(i,{label:""},{default:l(()=>[x("div",Pe,[Be,e(C,{onClick:r[5]||(r[5]=w=>_(t(m)))},{default:l(()=>[h("重置")]),_:1}),e(C,{type:"primary",onClick:t(g)},{default:l(()=>[h("查询")]),_:1},8,["onClick"]),e(y,{type:"primary",underline:!1,onClick:r[6]||(r[6]=w=>s.value=!t(s)),style:{"margin-left":"12px"}},{default:l(()=>[x("span",null,U(t(s)?"展开":"收起"),1),e($,{style:{"margin-left":"8px"}},{default:l(()=>[(D(),M(oe(t(s)?t(Ye):t(Te))))]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ee=re(Je,[["__scopeId","data-v-45e405e8"]]),Ke={style:{display:"inline-block",cursor:"pointer"}},Le={style:{"text-align":"center"}},qe=A({__name:"CustomFilter",props:{columnKey:{},filters:{}},emits:["filterChange"],setup(b,{emit:g}){const n=b,m=g,s=p(),_=p([]),k=p(!1);function r(){s==null||s.value.hide()}function f(){_.value=[];const d={[n.columnKey]:[]};m("filterChange",d),r()}function i(){const d={[n.columnKey]:_.value};m("filterChange",d),r()}return(d,c)=>{const C=o("ArrowUp"),$=o("ArrowDown"),y=o("el-icon"),T=o("el-checkbox"),j=o("el-checkbox-group"),z=o("el-divider"),w=o("el-button"),N=o("el-popover");return D(),M(N,{ref_key:"popoverRef",ref:s,width:160,effect:"light",placement:"bottom",trigger:"click",onShow:c[1]||(c[1]=V=>k.value=!0),onHide:c[2]||(c[2]=V=>k.value=!1)},{reference:l(()=>[x("span",Ke,[e(y,null,{default:l(()=>[t(k)?(D(),M(C,{key:0})):(D(),M($,{key:1}))]),_:1})])]),default:l(()=>[x("div",null,[e(j,{modelValue:t(_),"onUpdate:modelValue":c[0]||(c[0]=V=>Y(_)?_.value=V:null)},{default:l(()=>[(D(!0),E(le,null,ee(n.filters,V=>(D(),M(T,{label:V.text,value:V.value,style:{display:"flex"}},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),e(z,{style:{margin:"8px 0"}}),x("div",Le,[e(w,{size:"small",onClick:f},{default:l(()=>[h("重置")]),_:1}),e(w,{size:"small",type:"primary",onClick:i},{default:l(()=>[h("确定")]),_:1})])])]),_:1},512)}}});function He(){const b=I(),g=Fe(),n=p(""),m=p(!1),s=p(!1),_=p(1);function k(){_.value===1?g.push({path:"/form/create"}):(n.value="新建活动",s.value=!1,m.value=!0)}async function r(d){const c=JSON.parse(JSON.stringify(d));_.value===1?g.push({path:"/form/update"}).then(()=>{J.emit("updateUser",c)}):(n.value="编辑活动",s.value=!0,m.value=!0,await te(),J.emit("updateUser",c))}function f(d){const c=JSON.parse(JSON.stringify(d));g.push({name:"basicDetail",params:{id:d.id}}).then(()=>{J.emit("viewUser",c)})}function i(){m.value=!1,b.getTableData()}return{dgTitle:n,dgOpen:m,isUpdate:s,dgType:_,gotoCreate:k,doUpdate:r,viewDetail:f,close:i}}const K=b=>(ne("data-v-60417c34"),b=b(),ae(),b),Xe={class:"custom-style",style:{"margin-bottom":"12px",display:"flex"}},Ze=K(()=>x("span",null,"新建",-1)),Ge=K(()=>x("span",null,"删除",-1)),Qe={style:{"margin-left":"auto"}},We=K(()=>x("span",{style:{display:"inline-block"}},"活动区域",-1)),el={style:{"margin-top":"20px"}},ll=A({__name:"PiniaTable",props:{query:Object},setup(b){const g=I(),{getTableData:n}=g,{tableData:m,pageSize:s,currentPage:_,total:k,orderBy:r,filters:f}=se(g),{dgTitle:i,dgOpen:d,isUpdate:c,dgType:C,gotoCreate:$,doUpdate:y,viewDetail:T,close:j}=He(),z=[{label:"跳转到编辑页面",value:1},{label:"打开编辑弹出框",value:2}],w=p(null),N=p(null),V=p([]),L=p();je(()=>{n()});function ue(v){const{prop:a,order:F}=v;if(!F)r.value=null;else{const R=F.indexOf("asc")===0?"asc":"desc";r.value=a+","+R}n()}function q(v){const a=JSON.parse(JSON.stringify(v));f.value=Object.assign(f.value,a),n()}function ie(v){V.value=v}async function de(){if(V.value.length===0){Q.info({message:"请选择要删除的数据"});return}const v=V.value.map(a=>a.id);await Ie(Oe(v)),Q.success({message:"删除成功"}),n()}function ce(v){return{shanghai:"区域一",beijing:"区域二"}[v]}function pe(v){return{0:"否",1:"是"}[v]}function me(v){return{1:"线上品牌商赞助",2:"线下场地免费"}[v]}function P(v,a){w.value=v,N.value=a}function _e({row:v,rowIndex:a}){if(a==w.value)return"green"}function fe({row:v,column:a,rowIndex:F,columnIndex:R}){if(R==N.value)return"green"}function ge(){m.value.forEach((v,a)=>{a===0&&t(L).toggleRowSelection(v,!0)})}return(v,a)=>{const F=o("Plus"),R=o("el-icon"),O=o("el-button"),ve=o("Delete"),be=o("arrow-down"),B=o("el-dropdown-item"),ye=o("el-dropdown-menu"),we=o("el-dropdown"),he=o("el-segmented"),S=o("el-table-column"),H=o("el-link"),ke=o("el-table"),Ce=o("el-pagination"),xe=o("el-card"),De=o("el-dialog");return D(),E("div",null,[e(Ee),e(xe,{style:{"margin-top":"20px"}},{default:l(()=>[x("div",Xe,[x("div",null,[e(O,{type:"primary",onClick:t($)},{default:l(()=>[e(R,null,{default:l(()=>[e(F)]),_:1}),Ze]),_:1},8,["onClick"]),e(O,{type:"primary",onClick:de},{default:l(()=>[e(R,null,{default:l(()=>[e(ve)]),_:1}),Ge]),_:1})]),x("div",Qe,[e(O,{type:"primary",onClick:ge},{default:l(()=>[h("选中第一行")]),_:1}),e(we,{style:{"margin-left":"20px"}},{dropdown:l(()=>[e(ye,null,{default:l(()=>[e(B,{onClick:a[0]||(a[0]=u=>P(1,null))},{default:l(()=>[h("高亮行")]),_:1}),e(B,{onClick:a[1]||(a[1]=u=>P(null,3))},{default:l(()=>[h("高亮列")]),_:1}),e(B,{onClick:a[2]||(a[2]=u=>P(null,null))},{default:l(()=>[h("取消高亮")]),_:1})]),_:1})]),default:l(()=>[e(O,{type:"primary"},{default:l(()=>[h(" 设置背景色"),e(R,{class:"el-icon--right"},{default:l(()=>[e(be)]),_:1})]),_:1})]),_:1}),e(he,{modelValue:t(C),"onUpdate:modelValue":a[3]||(a[3]=u=>Y(C)?C.value=u:null),options:z,style:{"margin-left":"20px"}},{default:l(({item:u})=>[x("div",null,U(u.label),1)]),_:1},8,["modelValue"])])]),e(ke,{border:"",stripe:"",style:{width:"100%"},ref_key:"tableRef",ref:L,data:t(m),"row-class-name":_e,"cell-class-name":fe,onSortChange:ue,onFilterChange:q,onSelectionChange:ie},{default:l(()=>[e(S,{fixed:"",type:"selection",width:"50"}),e(S,{fixed:"",prop:"name",label:"活动名称",width:"180"}),e(S,{prop:"region"},{header:l(()=>[We,e(qe,{"column-key":"region",filters:[{text:"区域一",value:"shanghai"},{text:"区域二",value:"beijing"}],onFilterChange:q})]),default:l(u=>[h(U(ce(u.row.region)),1)]),_:1}),e(S,{prop:"beginDate",label:"开始时间",sortable:"custom"},{default:l(u=>[h(U(t(X)(u.row.beginDate,"YYYY-MM-DD")),1)]),_:1}),e(S,{prop:"endDate",label:"结束时间"},{default:l(u=>[h(U(t(X)(u.row.endDate,"YYYY-MM-DD")),1)]),_:1}),e(S,{prop:"jit",label:"即时配送","column-key":"jit",filters:[{text:"是",value:1},{text:"否",value:0}]},{default:l(u=>[h(U(pe(u.row.jit)),1)]),_:1}),e(S,{prop:"resource",label:"特殊资源"},{default:l(u=>[h(U(me(u.row.resource)),1)]),_:1}),e(S,{prop:"desc",label:"活动形式"},{default:l(u=>[e(Ue,{content:u.row.desc},null,8,["content"])]),_:1}),e(S,{fixed:"right",label:"操作",width:"100"},{default:l(u=>[e(H,{underline:!1,type:"primary",onClick:Ve=>t(T)(u.row)},{default:l(()=>[h("查看")]),_:2},1032,["onClick"]),e(H,{underline:!1,type:"primary",onClick:Ve=>t(y)(u.row),style:{"margin-left":"10px"}},{default:l(()=>[h("编辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),x("div",el,[e(Ce,{layout:"total, prev, pager, next, sizes","current-page":t(_),"onUpdate:currentPage":a[4]||(a[4]=u=>Y(_)?_.value=u:null),"page-size":t(s),"onUpdate:pageSize":a[5]||(a[5]=u=>Y(s)?s.value=u:null),"page-sizes":[10,20,50,100],total:t(k),onSizeChange:t(n),onCurrentChange:t(n)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),e(De,{modelValue:t(d),"onUpdate:modelValue":a[6]||(a[6]=u=>Y(d)?d.value=u:null),title:t(i),"close-on-click-modal":!1,width:"50%"},{default:l(()=>[(D(),M(oe(t(c)?Me:Se),{"is-dialog":!0,onClose:t(j)},null,40,["onClose"]))]),_:1},8,["modelValue","title"])])}}}),pl=re(ll,[["__scopeId","data-v-60417c34"]]);export{pl as default};

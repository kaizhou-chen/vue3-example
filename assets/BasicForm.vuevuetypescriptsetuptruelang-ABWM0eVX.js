import{b as B}from"./bus-CdlF-dbX.js";import{s as q}from"./marketingApi-SjjHtNYj.js";import{c as Z,u as z}from"./apiFactory-ClI1cCsn.js";import{u as A,a as N}from"./main-cgMtkIPo.js";import{d as G,r as g,g as Y,$ as H,a2 as P,j as Q,a as s,o as h,I as W,e,w as o,u as l,Z as d,X as ee,b as te,Y as C,K as oe,a1 as le}from"./index-CIcVr1hx.js";function M(a){let u=JSON.parse(JSON.stringify(a));return u.type=u.type.join(","),u}function ne(a){const u={};return Object.assign(u,a),(a==null?void 0:a.type)!=null?u.type=a==null?void 0:a.type.split(",").map(Number):u.type=[],(a==null?void 0:a.jit)!=null?u.jit=Number(a==null?void 0:a.jit):u.jit=0,u}const ae={style:{display:"flex","justify-content":"center"}},re={style:{display:"flex","justify-content":"center",width:"100%"}},pe=G({__name:"BasicForm",props:{isDialog:Boolean,isUpdate:Boolean},emits:["close"],setup(a,{emit:u}){const _=a,R=u,y=A(),F=N(),p=g(),n=Y({name:"",region:"",beginDate:"",endDate:"",jit:0,type:[],resource:null,desc:""}),O=Y({name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],region:[{required:!0,message:"请选择活动区域",trigger:"change"}],beginDate:[{type:"string",required:!0,message:"请选择开始时间",trigger:"change"}],endDate:[{type:"string",required:!0,message:"请选择结束时间",trigger:"change"}],type:[{type:"array",required:!0,message:"请至少选择一个活动性质",trigger:"change"}],resource:[{required:!0,message:"请选择活动资源",trigger:"change"}],desc:[{required:!0,message:"请填写活动形式",trigger:"blur"}]});g(!1);const V=g("确定"),v=g(!0);H(()=>{B.on("updateUser",t=>{const c=ne(t);Object.assign(n,c)}),N().name==="basicForm"&&(v.value=!1)}),P(()=>{B.off("updateUser")}),Q(()=>_.isUpdate,i=>{i&&(V.value="提交")},{immediate:!0});function S(i){D()}function E(i){i.validate(t=>{if(!t)return console.log("error submit!!"),!1;_.isUpdate?$():T()})}async function T(){const i=M(n),t=await q(Z(i));k(t)}async function $(){const i=M(n),t=await q(z(i));k(t)}function k(i){i.data.success&&(le.success({message:"操作成功"}),D())}function D(){if(p.value.resetFields(),F.name==="basicForm"){y.push({name:"basicTable"});return}if(_.isDialog){R("close");return}y.back()}return(i,t)=>{const c=s("el-input"),m=s("el-form-item"),x=s("el-option"),J=s("el-select"),U=s("el-date-picker"),b=s("el-col"),I=s("el-switch"),f=s("el-checkbox"),K=s("el-checkbox-group"),j=s("el-radio"),L=s("el-radio-group"),w=s("el-button"),X=s("el-form");return h(),W("div",ae,[e(X,{style:{"max-width":"600px"},ref_key:"formRef",ref:p,model:l(n),rules:l(O),"label-width":"auto"},{default:o(()=>[e(m,{label:"活动名称",prop:"name"},{default:o(()=>[e(c,{modelValue:l(n).name,"onUpdate:modelValue":t[0]||(t[0]=r=>l(n).name=r)},null,8,["modelValue"])]),_:1}),e(m,{label:"活动区域",prop:"region"},{default:o(()=>[e(J,{modelValue:l(n).region,"onUpdate:modelValue":t[1]||(t[1]=r=>l(n).region=r),placeholder:"请选择活动区域"},{default:o(()=>[e(x,{label:"区域一",value:"shanghai"}),e(x,{label:"区域二",value:"beijing"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"活动时间",required:""},{default:o(()=>[e(b,{span:11},{default:o(()=>[e(m,{prop:"beginDate"},{default:o(()=>[e(U,{placeholder:"开始时间",modelValue:l(n).beginDate,"onUpdate:modelValue":t[2]||(t[2]=r=>l(n).beginDate=r),type:"date","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{span:2,style:{"text-align":"center"}},{default:o(()=>[d("-")]),_:1}),e(b,{span:11},{default:o(()=>[e(m,{prop:"endDate"},{default:o(()=>[e(U,{placeholder:"结束时间",modelValue:l(n).endDate,"onUpdate:modelValue":t[3]||(t[3]=r=>l(n).endDate=r),type:"date","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(m,{label:"即时配送"},{default:o(()=>[e(I,{modelValue:l(n).jit,"onUpdate:modelValue":t[4]||(t[4]=r=>l(n).jit=r),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(m,{label:"活动性质",prop:"type"},{default:o(()=>[e(K,{modelValue:l(n).type,"onUpdate:modelValue":t[5]||(t[5]=r=>l(n).type=r)},{default:o(()=>[e(f,{value:1,name:"type"},{default:o(()=>[d("美食/餐厅线上活动")]),_:1}),e(f,{value:2,name:"type"},{default:o(()=>[d("地推活动")]),_:1}),e(f,{value:3,name:"type"},{default:o(()=>[d("线下主题活动")]),_:1}),e(f,{value:4,name:"type"},{default:o(()=>[d("单纯品牌曝光")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"特殊资源",prop:"resource"},{default:o(()=>[e(L,{modelValue:l(n).resource,"onUpdate:modelValue":t[6]||(t[6]=r=>l(n).resource=r)},{default:o(()=>[e(j,{value:1},{default:o(()=>[d("线上品牌商赞助")]),_:1}),e(j,{value:2},{default:o(()=>[d("线下场地免费")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"活动形式",prop:"desc"},{default:o(()=>[e(c,{type:"textarea",modelValue:l(n).desc,"onUpdate:modelValue":t[7]||(t[7]=r=>l(n).desc=r),rows:5},null,8,["modelValue"])]),_:1}),e(m,null,{default:o(()=>[ee("div",re,[l(v)?(h(),te(w,{key:0,onClick:t[8]||(t[8]=r=>S(l(p)))},{default:o(()=>[d(C(a.isDialog?"取消":"返回"),1)]),_:1})):oe("",!0),e(w,{type:"primary",onClick:t[9]||(t[9]=r=>E(l(p)))},{default:o(()=>[d(C(l(V)),1)]),_:1})])]),_:1})]),_:1},8,["model","rules"])])}}});export{pe as _};

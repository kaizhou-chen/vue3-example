import{b as _}from"./bus.CdlF-dbX.2024-07-16_10.07.08.js";import{d as g,i as x,r as k,$ as w,a0 as b,a as u,o as i,I as d,e as p,w as R,L as B,M as I,b as C,Y as E}from"./index.CrWuBC7G.2024-07-16_10.07.08.js";import{_ as L}from"./plugin-vueexport-helper.DlAUqK2U.2024-07-16_10.07.08.js";const T={key:0,class:"children"},M={key:1,class:"label"},S=g({__name:"RuleEngineItem",props:{data:{},parent:{},index:{}},setup(h){const a=h,f=x("draw"),l=k();w(()=>{l.value.dataset.id=a.data.id,_.on("update-svg",()=>{if(!a.data.children){const o=y(l.value.querySelector(".el-select"),!0),s=$(l.value.querySelector(".label"));m(o,s,!0)}if(!a.parent)return;const e=a.index===0,t=y(document.querySelector(`[data-id="${a.parent.id}"] .el-select`),e),n=$(l.value);m(t,n,e)})}),b(()=>{_.off("update-svg")});function m(e,t,n){if(n)f.path(`M${e.x} ${e.y} L${t.x} ${t.y}`).stroke({color:"#ccc",width:2,linecap:"round",linejoin:"round"});else{const o=`M${e.x} ${e.y}`,s=`v${t.y-e.y-20}`,r=`Q${e.x+5} ${t.y-5} ${t.x-20} ${t.y}`,c=`L${t.x} ${t.y}`,v=f.path(`${o} ${s} ${r} ${c}`);v.stroke({color:"#ccc",width:2,linecap:"round",linejoin:"round"}),v.fill("none")}}function y(e,t){const n=e.getBoundingClientRect();return t?{x:n.left+n.width,y:n.top+16}:{x:n.left+60,y:n.top+32}}function $(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top+16}}return(e,t)=>{const n=u("el-option"),o=u("el-select"),s=u("RuleEngineItem",!0);return i(),d("div",{ref_key:"itemRef",ref:l,class:"item"},[p(o,{modelValue:e.data.condition,"onUpdate:modelValue":t[0]||(t[0]=r=>e.data.condition=r),style:{width:"75px"}},{default:R(()=>[p(n,{label:"或者",value:"or"}),p(n,{label:"并且",value:"and"})]),_:1},8,["modelValue"]),e.data.children?(i(),d("div",T,[(i(!0),d(B,null,I(e.data.children,(r,c)=>(i(),C(s,{key:c,data:r,parent:e.data,index:c},null,8,["data","parent","index"]))),128))])):(i(),d("div",M,E(e.data.label),1))],512)}}}),P=L(S,[["__scopeId","data-v-ed87f90c"]]);export{P as default};

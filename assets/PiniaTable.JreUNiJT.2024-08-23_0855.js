import{f as Q}from"./dateUtils.BCPDPJFQ.2024-08-23_0855.js";import{_ as Se}from"./AddMarketing.vuevuetypescriptsetuptruelang.BoPovYH3.2024-08-23_0855.js";import{_ as Me}from"./EditMarketing.vuevuetypescriptsetuptruelang.Dhag5gkQ.2024-08-23_0855.js";import{A as Ue}from"./AutoTooltip.C7loubCa.2024-08-23_0855.js";import{d as A,aD as Re,aE as $e,b as c,ai as o,o as D,M,O as t,U as e,u as l,D as T,c as E,a8 as ee,S as h,T as U,F as te,n as le,P as G,V as W,a as x,Q as oe,az as ne,aA as ae,j as Te}from"./@vue.BRKSBXdb.2024-08-23_0855.js";import{R as je,S as Ye}from"./@element-plus.CXiHu7Kc.2024-08-23_0855.js";import{d as ze,s as re}from"./pinia.Br8pGA2w.2024-08-23_0855.js";import{l as Fe,r as Oe}from"./apiFactory.8NzLZck3.2024-08-23_0855.js";import{_ as se}from"./plugin-vueexport-helper.DlAUqK2U.2024-08-23_0855.js";import{u as Ne}from"./vue-router.CZo7Iq1Y.2024-08-23_0855.js";import{b as J}from"./bus.C7soAy4q.2024-08-23_0855.js";import{a as Ie}from"./marketingApi.ChXSgcdM.2024-08-23_0855.js";import{a as X}from"./element-plus.DJt1SzqQ.2024-08-23_0855.js";import"./dayjs.CPVlA08G.2024-08-23_0855.js";import"./call-bind.DAUNaQ65.2024-08-23_0855.js";import"./get-intrinsic.DB0lrOCt.2024-08-23_0855.js";import"./es-errors.DzOT6E3C.2024-08-23_0855.js";import"./has-symbols.eVqrYdw7.2024-08-23_0855.js";import"./has-proto.JnoBQRdH.2024-08-23_0855.js";import"./function-bind.BbkWVFrm.2024-08-23_0855.js";import"./hasown.D9QVQHSI.2024-08-23_0855.js";import"./set-function-length.D_FcvHgY.2024-08-23_0855.js";import"./define-data-property.DjNWBd2S.2024-08-23_0855.js";import"./es-define-property.CFiic7Xl.2024-08-23_0855.js";import"./gopd.BJopahKq.2024-08-23_0855.js";import"./has-property-descriptors.PcPi-1-h.2024-08-23_0855.js";import"./mitt.DJ65BbbF.2024-08-23_0855.js";import"./qs.DGMyDzwg.2024-08-23_0855.js";import"./side-channel.CZsUielb.2024-08-23_0855.js";import"./object-inspect.CXNgtm8E.2024-08-23_0855.js";import"./axios.DsPaXkF5.2024-08-23_0855.js";import"./http.Dpy_JggD.2024-08-23_0855.js";import"./lodash-es.DvWjmQkM.2024-08-23_0855.js";import"./@vueuse.CSofjJuH.2024-08-23_0855.js";import"./@popperjs.D9SI2xQl.2024-08-23_0855.js";import"./@ctrl.r5W6hzzQ.2024-08-23_0855.js";import"./async-validator.DKvM95Vc.2024-08-23_0855.js";import"./memoize-one.BdPwpGay.2024-08-23_0855.js";import"./normalize-wheel-es.B6fDCfyv.2024-08-23_0855.js";import"./@floating-ui.DF51-gJp.2024-08-23_0855.js";const Z=A({__name:"MultiSelect",props:Re({options:{},placeholder:{}},{modelValue:{default:[]},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const g=$e(b,"modelValue"),n=b,m=c(!1),r=c([]);function _(s){let f=[];s&&(f=n.options.map(u=>u.value)),g.value=[...f],r.value=[...f]}async function k(){r.value=[...g.value],await le(),m.value=g.value.length===n.options.length}return(s,f)=>{const u=o("el-checkbox"),p=o("el-text"),d=o("el-option"),C=o("el-checkbox-group"),R=o("el-select");return D(),M(R,{multiple:"",modelValue:g.value,"onUpdate:modelValue":f[2]||(f[2]=y=>g.value=y),placeholder:s.placeholder,onChange:k},{default:t(()=>[e(u,{label:"全选",modelValue:l(m),"onUpdate:modelValue":f[0]||(f[0]=y=>T(m)?m.value=y:null),onChange:_,style:{"padding-left":"20px",width:"calc(100% - 20px)"}},null,8,["modelValue"]),e(C,{modelValue:l(r),"onUpdate:modelValue":f[1]||(f[1]=y=>T(r)?r.value=y:null)},{default:t(()=>[(D(!0),E(te,null,ee(s.options,y=>(D(),M(d,{key:y.value,label:y.label,value:y.value},{default:t(()=>[e(u,{value:y.value,style:{width:"100%"}},{default:t(()=>[e(p,{truncated:""},{default:t(()=>[h(U(y.label),1)]),_:2},1024)]),_:2},1032,["value"])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])}}}),I=ze("marketingTable",()=>{const b=c([]),g=c(0),n=c(10),m=c(1),r=c(),_=c({}),k=c({name:"",beginDate:"",endDate:"",region:[],jit:[]});async function s(){const u=f(),p=await Fe(u),{list:d,pageInfo:C}=p.data;b.value=d,g.value=C.total}function f(){const u={};return u.pageSize=n.value,u.pageNumber=m.value,r.value&&(u.orderBy=r.value),["name","beginDate","endDate","jit","region"].forEach(d=>{const C=k.value[d];C!==""&&(u[d]=C)}),_.value&&Object.assign(u,_.value),u}return{tableData:b,total:g,form:k,pageSize:n,currentPage:m,orderBy:r,filters:_,getTableData:s}}),Ae=b=>(ne("data-v-45e405e8"),b=b(),ae(),b),Pe={style:{display:"flex",width:"100%"}},Be=Ae(()=>x("div",{style:{flex:"1"}},null,-1)),Je=A({__name:"SearchForm",setup(b){const{getTableData:g}=I(),{form:n}=re(I()),m=c(),r=c(!0);function _(k){k.resetFields(),n.value.jit=[],n.value.region=[],g()}return(k,s)=>{const f=o("el-input"),u=o("el-form-item"),p=o("el-col"),d=o("el-date-picker"),C=o("el-button"),R=o("el-icon"),y=o("el-link"),j=o("el-row"),Y=o("el-form"),z=o("el-card");return D(),M(z,null,{default:t(()=>[e(Y,{ref_key:"formRef",ref:m,model:l(n),inline:!0,"label-width":"auto"},{default:t(()=>[e(j,{gutter:20},{default:t(()=>[e(p,{span:6},{default:t(()=>[e(u,{label:"活动名称",prop:"name"},{default:t(()=>[e(f,{modelValue:l(n).name,"onUpdate:modelValue":s[0]||(s[0]=w=>l(n).name=w),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:6},{default:t(()=>[e(u,{label:"开始时间",prop:"beginDate"},{default:t(()=>[e(d,{placeholder:"开始时间",modelValue:l(n).beginDate,"onUpdate:modelValue":s[1]||(s[1]=w=>l(n).beginDate=w),type:"date","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:6},{default:t(()=>[e(u,{label:"结束时间",prop:"endDate"},{default:t(()=>[e(d,{placeholder:"结束时间",modelValue:l(n).endDate,"onUpdate:modelValue":s[2]||(s[2]=w=>l(n).endDate=w),type:"date","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),G(e(p,{span:6},{default:t(()=>[e(u,{label:"活动区域",prop:"region"},{default:t(()=>[e(Z,{modelValue:l(n).region,"onUpdate:modelValue":s[3]||(s[3]=w=>l(n).region=w),placeholder:"请选择活动区域",options:[{label:"区域一",value:"shanghai"},{label:"区域二",value:"beijing"}]},null,8,["modelValue"])]),_:1})]),_:1},512),[[W,!l(r)]]),G(e(p,{span:6},{default:t(()=>[e(u,{label:"即时配送",prop:"region"},{default:t(()=>[e(Z,{modelValue:l(n).jit,"onUpdate:modelValue":s[4]||(s[4]=w=>l(n).jit=w),placeholder:"请选择配送方式",options:[{label:"是",value:1},{label:"否",value:0}]},null,8,["modelValue"])]),_:1})]),_:1},512),[[W,!l(r)]]),e(p,{span:6,style:{"margin-left":"auto","margin-bottom":"0px"}},{default:t(()=>[e(u,{label:""},{default:t(()=>[x("div",Pe,[Be,e(C,{onClick:s[5]||(s[5]=w=>_(l(m)))},{default:t(()=>[h("重置")]),_:1}),e(C,{type:"primary",onClick:l(g)},{default:t(()=>[h("查询")]),_:1},8,["onClick"]),e(y,{type:"primary",underline:!1,onClick:s[6]||(s[6]=w=>r.value=!l(r)),style:{"margin-left":"12px"}},{default:t(()=>[x("span",null,U(l(r)?"展开":"收起"),1),e(R,{style:{"margin-left":"8px"}},{default:t(()=>[(D(),M(oe(l(r)?l(je):l(Ye))))]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ee=se(Je,[["__scopeId","data-v-45e405e8"]]),Ke={style:{display:"inline-block",cursor:"pointer"}},qe={style:{"text-align":"center"}},Le=A({__name:"CustomFilter",props:{columnKey:{},filters:{}},emits:["filterChange"],setup(b,{emit:g}){const n=b,m=g,r=c(),_=c([]),k=c(!1);function s(){r==null||r.value.hide()}function f(){_.value=[];const p={[n.columnKey]:[]};m("filterChange",p),s()}function u(){const p={[n.columnKey]:_.value};m("filterChange",p),s()}return(p,d)=>{const C=o("ArrowUp"),R=o("ArrowDown"),y=o("el-icon"),j=o("el-checkbox"),Y=o("el-checkbox-group"),z=o("el-divider"),w=o("el-button"),O=o("el-popover");return D(),M(O,{ref_key:"popoverRef",ref:r,width:160,effect:"light",placement:"bottom",trigger:"click",onShow:d[1]||(d[1]=V=>k.value=!0),onHide:d[2]||(d[2]=V=>k.value=!1)},{reference:t(()=>[x("span",Ke,[e(y,null,{default:t(()=>[l(k)?(D(),M(C,{key:0})):(D(),M(R,{key:1}))]),_:1})])]),default:t(()=>[x("div",null,[e(Y,{modelValue:l(_),"onUpdate:modelValue":d[0]||(d[0]=V=>T(_)?_.value=V:null)},{default:t(()=>[(D(!0),E(te,null,ee(n.filters,V=>(D(),M(j,{label:V.text,value:V.value,style:{display:"flex"}},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),e(z,{style:{margin:"8px 0"}}),x("div",qe,[e(w,{size:"small",onClick:f},{default:t(()=>[h("重置")]),_:1}),e(w,{size:"small",type:"primary",onClick:u},{default:t(()=>[h("确定")]),_:1})])])]),_:1},512)}}});function He(){const b=I(),g=Ne(),n=c(""),m=c(!1),r=c(!1),_=c(1);function k(){_.value===1?g.push({path:"/form/create"}):(n.value="新建活动",r.value=!1,m.value=!0)}async function s(p){const d=JSON.parse(JSON.stringify(p));_.value===1?g.push({path:"/form/update"}).then(()=>{J.emit("updateUser",d)}):(n.value="编辑活动",r.value=!0,m.value=!0,await le(),J.emit("updateUser",d))}function f(p){const d=JSON.parse(JSON.stringify(p));g.push({name:"basicDetail",params:{id:p.id}}).then(()=>{J.emit("viewUser",d)})}function u(){m.value=!1,b.getTableData()}return{dgTitle:n,dgOpen:m,isUpdate:r,dgType:_,gotoCreate:k,doUpdate:s,viewDetail:f,close:u}}const K=b=>(ne("data-v-60417c34"),b=b(),ae(),b),Qe={class:"custom-style",style:{"margin-bottom":"12px",display:"flex"}},Ge=K(()=>x("span",null,"新建",-1)),We=K(()=>x("span",null,"删除",-1)),Xe={style:{"margin-left":"auto"}},Ze=K(()=>x("span",{style:{display:"inline-block"}},"活动区域",-1)),et={style:{"margin-top":"20px"}},tt=A({__name:"PiniaTable",props:{query:Object},setup(b){const g=I(),{getTableData:n}=g,{tableData:m,pageSize:r,currentPage:_,total:k,orderBy:s,filters:f}=re(g),{dgTitle:u,dgOpen:p,isUpdate:d,dgType:C,gotoCreate:R,doUpdate:y,viewDetail:j,close:Y}=He(),z=[{label:"跳转到编辑页面",value:1},{label:"打开编辑弹出框",value:2}],w=c(null),O=c(null),V=c([]),q=c();Te(()=>{n()});function ie(v){const{prop:a,order:F}=v;if(!F)s.value=null;else{const $=F.indexOf("asc")===0?"asc":"desc";s.value=a+","+$}n()}function L(v){const a=JSON.parse(JSON.stringify(v));f.value=Object.assign(f.value,a),n()}function ue(v){V.value=v}async function pe(){if(V.value.length===0){X.info({message:"请选择要删除的数据"});return}const v=V.value.map(a=>a.id);await Ie(Oe(v)),X.success({message:"删除成功"}),n()}function de(v){return{shanghai:"区域一",beijing:"区域二"}[v]}function ce(v){return{0:"否",1:"是"}[v]}function me(v){return{1:"线上品牌商赞助",2:"线下场地免费"}[v]}function P(v,a){w.value=v,O.value=a}function _e({row:v,rowIndex:a}){if(a==w.value)return"green"}function fe({row:v,column:a,rowIndex:F,columnIndex:$}){if($==O.value)return"green"}function ge(){m.value.forEach((v,a)=>{a===0&&l(q).toggleRowSelection(v,!0)})}return(v,a)=>{const F=o("Plus"),$=o("el-icon"),N=o("el-button"),ve=o("Delete"),be=o("arrow-down"),B=o("el-dropdown-item"),ye=o("el-dropdown-menu"),we=o("el-dropdown"),he=o("el-segmented"),S=o("el-table-column"),H=o("el-link"),ke=o("el-table"),Ce=o("el-pagination"),xe=o("el-card"),De=o("el-dialog");return D(),E("div",null,[e(Ee),e(xe,{style:{"margin-top":"20px"}},{default:t(()=>[x("div",Qe,[x("div",null,[e(N,{type:"primary",onClick:l(R)},{default:t(()=>[e($,null,{default:t(()=>[e(F)]),_:1}),Ge]),_:1},8,["onClick"]),e(N,{type:"primary",onClick:pe},{default:t(()=>[e($,null,{default:t(()=>[e(ve)]),_:1}),We]),_:1})]),x("div",Xe,[e(N,{type:"primary",onClick:ge},{default:t(()=>[h("选中第一行")]),_:1}),e(we,{style:{"margin-left":"20px"}},{dropdown:t(()=>[e(ye,null,{default:t(()=>[e(B,{onClick:a[0]||(a[0]=i=>P(1,null))},{default:t(()=>[h("高亮行")]),_:1}),e(B,{onClick:a[1]||(a[1]=i=>P(null,3))},{default:t(()=>[h("高亮列")]),_:1}),e(B,{onClick:a[2]||(a[2]=i=>P(null,null))},{default:t(()=>[h("取消高亮")]),_:1})]),_:1})]),default:t(()=>[e(N,{type:"primary"},{default:t(()=>[h(" 设置背景色"),e($,{class:"el-icon--right"},{default:t(()=>[e(be)]),_:1})]),_:1})]),_:1}),e(he,{modelValue:l(C),"onUpdate:modelValue":a[3]||(a[3]=i=>T(C)?C.value=i:null),options:z,style:{"margin-left":"20px"}},{default:t(({item:i})=>[x("div",null,U(i.label),1)]),_:1},8,["modelValue"])])]),e(ke,{border:"",stripe:"",style:{width:"100%"},ref_key:"tableRef",ref:q,data:l(m),"row-class-name":_e,"cell-class-name":fe,onSortChange:ie,onFilterChange:L,onSelectionChange:ue},{default:t(()=>[e(S,{fixed:"",type:"selection",width:"50"}),e(S,{fixed:"",prop:"name",label:"活动名称",width:"180"}),e(S,{prop:"region"},{header:t(()=>[Ze,e(Le,{"column-key":"region",filters:[{text:"区域一",value:"shanghai"},{text:"区域二",value:"beijing"}],onFilterChange:L})]),default:t(i=>[h(U(de(i.row.region)),1)]),_:1}),e(S,{prop:"beginDate",label:"开始时间",sortable:"custom"},{default:t(i=>[h(U(l(Q)(i.row.beginDate,"YYYY-MM-DD")),1)]),_:1}),e(S,{prop:"endDate",label:"结束时间"},{default:t(i=>[h(U(l(Q)(i.row.endDate,"YYYY-MM-DD")),1)]),_:1}),e(S,{prop:"jit",label:"即时配送","column-key":"jit",filters:[{text:"是",value:1},{text:"否",value:0}]},{default:t(i=>[h(U(ce(i.row.jit)),1)]),_:1}),e(S,{prop:"resource",label:"特殊资源"},{default:t(i=>[h(U(me(i.row.resource)),1)]),_:1}),e(S,{prop:"desc",label:"活动形式"},{default:t(i=>[e(Ue,{content:i.row.desc},null,8,["content"])]),_:1}),e(S,{fixed:"right",label:"操作",width:"100"},{default:t(i=>[e(H,{underline:!1,type:"primary",onClick:Ve=>l(j)(i.row)},{default:t(()=>[h("查看")]),_:2},1032,["onClick"]),e(H,{underline:!1,type:"primary",onClick:Ve=>l(y)(i.row),style:{"margin-left":"10px"}},{default:t(()=>[h("编辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),x("div",et,[e(Ce,{layout:"total, prev, pager, next, sizes","current-page":l(_),"onUpdate:currentPage":a[4]||(a[4]=i=>T(_)?_.value=i:null),"page-size":l(r),"onUpdate:pageSize":a[5]||(a[5]=i=>T(r)?r.value=i:null),"page-sizes":[10,20,50,100],total:l(k),onSizeChange:l(n),onCurrentChange:l(n)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),e(De,{modelValue:l(p),"onUpdate:modelValue":a[6]||(a[6]=i=>T(p)?p.value=i:null),title:l(u),"close-on-click-modal":!1,width:"50%"},{default:t(()=>[(D(),M(oe(l(d)?Me:Se),{"is-dialog":!0,onClose:l(Y)},null,40,["onClose"]))]),_:1},8,["modelValue","title"])])}}}),Bt=se(tt,[["__scopeId","data-v-60417c34"]]);export{Bt as default};

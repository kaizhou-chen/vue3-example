import{a as S,l as Y,r as Z}from"./marketingApi-D-fY137l.js";import{d as q,r as n,$ as G,a as _,o as r,I as d,e as i,w as a,Z as C,u as e,Y as m,K as f,l as U,X as M,a1 as F}from"./index-DUm034Nc.js";const H={style:{width:"600px"}},J={key:0,class:"el-upload__tip"},Q={key:1,class:"el-upload__tip"},W={key:2,class:"el-upload__tip"},ee={key:0,class:"el-upload__tip"},te={key:1,class:"el-upload__tip"},oe={key:2,class:"el-upload__tip"},le=["src"],ne=M("div",{style:{height:"30px"}},null,-1),ce=q({__name:"StepItem3",setup(ae,{expose:T}){const I=n(),$=n(S.api+"/marketing/upload"),A=n(S.api+"/marketing/download"),x=n(".jpg,.jpeg,.png,.pdf,.doc,.docx,.xls,.xlsx"),y=n(10),p=n(""),c=n(""),u=n(""),N=n(""),w=n(!1),v=n([]),g=n([]);G(async()=>{const l=(await Y({})).data.data.map(s=>({name:s,url:A.value+"/"+s}));v.value=[...l],g.value=[...l]});function P(t,o){j();let l=`最多只能选择${y.value}个文件`;o.length>0&&(l=`最多只能选择${y.value-o.length}个文件 (已经上传过${o.length}个文件)`),p.value=l,F.warning({message:l})}function D(t){R(t,v)}function K(t){R(t,g)}function R(t,o){j();const l=10,s=x.value.split(","),k=t.name.substring(t.name.lastIndexOf(".")),V=s.indexOf(k)>-1,b=t.size/1024/1024>l;if(!V){const E=x.value.replace(/\./g,"").replace(",",", ");return c.value=`上传文件只能是 ${E} 类型`,z(t,c.value,o),!1}return b?(u.value=`文件大小不能超过${l}M`,z(t,u.value,o),!1):!0}function j(){p.value="",c.value="",u.value=""}function z(t,o,l){F.warning({message:o});const s=l.value.indexOf(t);l.value.splice(s,1)}function L(){I.value.submit()}function O(t){N.value=t.url,w.value=!0}function B(t,o){console.log("handleRemove",t),Z({filename:t.name})}function X(){return new Promise((t,o)=>{t(!0)})}return T({validate:X}),(t,o)=>{const l=_("el-divider"),s=_("el-button"),k=_("el-upload"),V=_("Plus"),b=_("el-icon"),E=_("el-dialog");return r(),d("div",H,[i(l,{"content-position":"left"},{default:a(()=>[C("手动上传")]),_:1}),i(k,{ref_key:"uploadRef",ref:I,"file-list":e(g),"onUpdate:fileList":o[0]||(o[0]=h=>U(g)?g.value=h:null),action:e($),"on-preview":O,"on-remove":B,multiple:"",limit:e(y),"on-exceed":P,accept:e(x),"auto-upload":!1,"on-change":K},{trigger:a(()=>[i(s,{type:"primary"},{default:a(()=>[C("选择文件")]),_:1})]),tip:a(()=>[e(p)!==""?(r(),d("div",J,m(e(p)),1)):f("",!0),e(c)!==""?(r(),d("div",Q,m(e(c)),1)):f("",!0),e(u)!==""?(r(),d("div",W,m(e(u)),1)):f("",!0)]),default:a(()=>[i(s,{class:"ml-3",type:"success",style:{"margin-left":"12px"},onClick:L},{default:a(()=>[C("点击上传")]),_:1})]),_:1},8,["file-list","action","limit","accept"]),i(l,{"content-position":"left"},{default:a(()=>[C("自动上传")]),_:1}),i(k,{"file-list":e(v),"onUpdate:fileList":o[1]||(o[1]=h=>U(v)?v.value=h:null),action:e($),"list-type":"picture-card","on-preview":O,"on-remove":B,multiple:"",limit:e(y),"on-exceed":P,accept:e(x),"before-upload":D},{tip:a(()=>[e(p)!==""?(r(),d("div",ee,m(e(p)),1)):f("",!0),e(c)!==""?(r(),d("div",te,m(e(c)),1)):f("",!0),e(u)!==""?(r(),d("div",oe,m(e(u)),1)):f("",!0)]),default:a(()=>[i(b,null,{default:a(()=>[i(V)]),_:1})]),_:1},8,["file-list","action","limit","accept"]),i(E,{modelValue:e(w),"onUpdate:modelValue":o[2]||(o[2]=h=>U(w)?w.value=h:null)},{default:a(()=>[M("img",{"w-full":"",src:e(N),alt:"Preview Image",style:{width:"100%",height:"100%"}},null,8,le)]),_:1},8,["modelValue"]),ne])}}});export{ce as _};

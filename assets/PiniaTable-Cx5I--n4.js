import{f as $}from"./dateUtils-CyxmbFrV.js";import{_ as ce}from"./BasicForm.vue_vue_type_script_setup_true_lang-BnritcrA.js";import{A as me}from"./AutoTooltip-D7Sl7xbR.js";import{u as P,S as fe}from"./SearchForm-CTXLGoNC.js";import{_ as _e}from"./CustomFilter.vue_vue_type_script_setup_true_lang-xtjXqVAv.js";import{u as ge,s as ve}from"./main-9VzDdX-P.js";import{b as N}from"./bus-CdlF-dbX.js";import{r as c,n as we,d as be,$ as ye,a as s,o as Ce,I as he,e,w as o,u as a,l as k,X as p,Z as r,Y as y,a1 as J,C as xe,D as Se}from"./index-CIcVr1hx.js";import{s as ke}from"./marketingApi-SjjHtNYj.js";import{r as De}from"./apiFactory-ClI1cCsn.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";function Te(){const v=P(),w=ge(),u=c(""),m=c(!1),f=c(!1),_=c(1);function D(){_.value===1?w.push({name:"createForm"}):(f.value=!1,m.value=!0)}async function h(d){const b=JSON.parse(JSON.stringify(d));_.value===1?w.push({name:"updateForm"}).then(()=>{N.emit("updateUser",b)}):(f.value=!0,m.value=!0,await we(),N.emit("updateUser",b))}function x(d){const b=JSON.parse(JSON.stringify(d));w.push({name:"basicDetail"}).then(()=>{N.emit("viewUser",b)})}function R(){m.value=!1,v.getTableData()}return{dgTitle:u,dgOpen:m,isUpdate:f,dgType:_,gotoCreate:D,doUpdate:h,viewDetail:x,close:R}}const V=v=>(xe("data-v-e8181bd6"),v=v(),Se(),v),Me={class:"custom-style",style:{"margin-bottom":"12px",display:"flex"}},Oe=V(()=>p("span",null,"新建",-1)),Ue=V(()=>p("span",null,"删除",-1)),Ne={style:{"margin-left":"auto"}},Ve=V(()=>p("span",{style:{display:"inline-block"}},"活动区域",-1)),Ye={style:{"margin-top":"20px"}},je=be({__name:"PiniaTable",props:{query:Object},setup(v){const w=P(),{getTableData:u}=w,{tableData:m,pageSize:f,currentPage:_,total:D,orderBy:h,filters:x}=ve(w),{dgTitle:R,dgOpen:d,isUpdate:b,dgType:T,gotoCreate:B,doUpdate:E,viewDetail:q,close:A}=Te(),X=[{label:"跳转到编辑页面",value:1},{label:"打开编辑弹出框",value:2}],Y=c(null),j=c(null),M=c([]),z=c();ye(()=>{u()});function Z(l){const{prop:t,order:C}=l;if(!C)h.value=null;else{const g=C.indexOf("asc")===0?"asc":"desc";h.value=t+","+g}u()}function F(l){const t=JSON.parse(JSON.stringify(l));x.value=Object.assign(x.value,t),u()}function G(l){M.value=l}async function H(){if(M.value.length===0){J.info({message:"请选择要删除的数据"});return}const l=M.value.map(t=>t.id);await ke(De(l)),J.success({message:"删除成功"}),u()}function K(l){return{shanghai:"区域一",beijing:"区域二"}[l]}function L(l){return{0:"否",1:"是"}[l]}function Q(l){return{1:"线上品牌商赞助",2:"线下场地免费"}[l]}function O(l,t){Y.value=l,j.value=t}function W({row:l,rowIndex:t}){if(t==Y.value)return"green"}function ee({row:l,column:t,rowIndex:C,columnIndex:g}){if(g==j.value)return"green"}function te(){m.value.forEach((l,t)=>{t===0&&a(z).toggleRowSelection(l,!0)})}return(l,t)=>{const C=s("Plus"),g=s("el-icon"),S=s("el-button"),ne=s("Delete"),oe=s("arrow-down"),U=s("el-dropdown-item"),le=s("el-dropdown-menu"),ae=s("el-dropdown"),se=s("el-segmented"),i=s("el-table-column"),I=s("el-link"),re=s("el-table"),ie=s("el-pagination"),ue=s("el-card"),de=s("el-dialog");return Ce(),he("div",null,[e(fe),e(ue,{style:{"margin-top":"20px"}},{default:o(()=>[p("div",Me,[p("div",null,[e(S,{type:"primary",onClick:a(B)},{default:o(()=>[e(g,null,{default:o(()=>[e(C)]),_:1}),Oe]),_:1},8,["onClick"]),e(S,{type:"primary",onClick:H},{default:o(()=>[e(g,null,{default:o(()=>[e(ne)]),_:1}),Ue]),_:1})]),p("div",Ne,[e(S,{type:"primary",onClick:te},{default:o(()=>[r("选中第一行")]),_:1}),e(ae,{style:{"margin-left":"20px"}},{dropdown:o(()=>[e(le,null,{default:o(()=>[e(U,{onClick:t[0]||(t[0]=n=>O(1,null))},{default:o(()=>[r("高亮行")]),_:1}),e(U,{onClick:t[1]||(t[1]=n=>O(null,3))},{default:o(()=>[r("高亮列")]),_:1}),e(U,{onClick:t[2]||(t[2]=n=>O(null,null))},{default:o(()=>[r("取消高亮")]),_:1})]),_:1})]),default:o(()=>[e(S,{type:"primary"},{default:o(()=>[r(" 设置背景色"),e(g,{class:"el-icon--right"},{default:o(()=>[e(oe)]),_:1})]),_:1})]),_:1}),e(se,{modelValue:a(T),"onUpdate:modelValue":t[3]||(t[3]=n=>k(T)?T.value=n:null),options:X,style:{"margin-left":"20px"}},{default:o(({item:n})=>[p("div",null,y(n.label),1)]),_:1},8,["modelValue"])])]),e(re,{border:"",stripe:"",style:{width:"100%"},ref_key:"tableRef",ref:z,data:a(m),"row-class-name":W,"cell-class-name":ee,onSortChange:Z,onFilterChange:F,onSelectionChange:G},{default:o(()=>[e(i,{fixed:"",type:"selection",width:"50"}),e(i,{fixed:"",prop:"name",label:"活动名称",width:"180"}),e(i,{prop:"region"},{header:o(()=>[Ve,e(_e,{"column-key":"region",filters:[{text:"区域一",value:"shanghai"},{text:"区域二",value:"beijing"}],onFilterChange:F})]),default:o(n=>[r(y(K(n.row.region)),1)]),_:1}),e(i,{prop:"beginDate",label:"开始时间",sortable:"custom"},{default:o(n=>[r(y(a($)(n.row.beginDate,"YYYY-MM-DD")),1)]),_:1}),e(i,{prop:"endDate",label:"结束时间"},{default:o(n=>[r(y(a($)(n.row.endDate,"YYYY-MM-DD")),1)]),_:1}),e(i,{prop:"jit",label:"即时配送","column-key":"jit",filters:[{text:"是",value:1},{text:"否",value:0}]},{default:o(n=>[r(y(L(n.row.jit)),1)]),_:1}),e(i,{prop:"resource",label:"特殊资源"},{default:o(n=>[r(y(Q(n.row.resource)),1)]),_:1}),e(i,{prop:"desc",label:"活动形式"},{default:o(n=>[e(me,{content:n.row.desc},null,8,["content"])]),_:1}),e(i,{fixed:"right",label:"操作",width:"100"},{default:o(n=>[e(I,{underline:!1,type:"primary",onClick:pe=>a(q)(n.row)},{default:o(()=>[r("查看")]),_:2},1032,["onClick"]),e(I,{underline:!1,type:"primary",onClick:pe=>a(E)(n.row),style:{"margin-left":"10px"}},{default:o(()=>[r("编辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),p("div",Ye,[e(ie,{layout:"total, prev, pager, next, sizes","current-page":a(_),"onUpdate:currentPage":t[4]||(t[4]=n=>k(_)?_.value=n:null),"page-size":a(f),"onUpdate:pageSize":t[5]||(t[5]=n=>k(f)?f.value=n:null),"page-sizes":[10,20,50,100],total:a(D),onSizeChange:a(u),onCurrentChange:a(u)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),e(de,{modelValue:a(d),"onUpdate:modelValue":t[6]||(t[6]=n=>k(d)?d.value=n:null),title:a(R),"close-on-click-modal":!1,width:"50%"},{default:o(()=>[e(ce,{"is-dialog":!0,"is-open":a(d),"is-update":a(b),onClose:a(A)},null,8,["is-open","is-update","onClose"])]),_:1},8,["modelValue","title"])])}}}),Ze=Re(je,[["__scopeId","data-v-e8181bd6"]]);export{Ze as default};

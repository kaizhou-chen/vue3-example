import{d as P,e as I,Z as N,j as F,f as R,ah as p,o as C,c as A,U as t,O as o,u as i,S as _,a as E,M as J,T as z,R as Z}from"./@vue.DR0bNimP.2024-07-17_1258.js";import"./marketingApi.CpdHMJCU.2024-07-17_1258.js";function G(e){let n=JSON.parse(JSON.stringify(e));return n.type=n.type.join(","),n}function ae(e){const n={};return Object.assign(n,e),(e==null?void 0:e.type)!=null?n.type=e==null?void 0:e.type.split(",").map(Number):n.type=[],(e==null?void 0:e.jit)!=null?n.jit=Number(e==null?void 0:e.jit):n.jit=0,n}const H={style:{display:"flex","justify-content":"center"}},K={style:{display:"flex","justify-content":"center",width:"100%"}},ie=P({__name:"MarketingForm",props:{data:{},cancelText:{}},emits:["submit","cancel"],setup(e,{expose:n,emit:r}){const u=e,c=r,m=I(),l=N({name:"",region:"",beginDate:"",endDate:"",jit:0,type:[],resource:null,desc:""}),s=N({name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],region:[{required:!0,message:"请选择活动区域",trigger:"change"}],beginDate:[{type:"string",required:!0,message:"请选择开始时间",trigger:"change"}],endDate:[{type:"string",required:!0,message:"请选择结束时间",trigger:"change"}],type:[{type:"array",required:!0,message:"请至少选择一个活动性质",trigger:"change"}],resource:[{required:!0,message:"请选择活动资源",trigger:"change"}]});F(()=>{u.data&&y(u.data)}),R(()=>u.data,g=>{y(g)});function y(g){Object.assign(l,g)}function k(g){c("cancel")}function q(g){g.validate(a=>{if(!a)return console.log("error submit!!"),!1;const V=G(l);c("submit",V)})}function O(){m.value.resetFields()}return n({reset:O}),(g,a)=>{const V=p("el-input"),f=p("el-form-item"),x=p("el-option"),Y=p("el-select"),j=p("el-date-picker"),M=p("el-col"),S=p("el-switch"),v=p("el-checkbox"),T=p("el-checkbox-group"),w=p("el-radio"),B=p("el-radio-group"),h=p("el-button"),$=p("el-form");return C(),A("div",H,[t($,{style:{"max-width":"600px"},ref_key:"formRef",ref:m,model:i(l),rules:i(s),"label-width":"auto"},{default:o(()=>[t(f,{label:"活动名称",prop:"name"},{default:o(()=>[t(V,{modelValue:i(l).name,"onUpdate:modelValue":a[0]||(a[0]=d=>i(l).name=d)},null,8,["modelValue"])]),_:1}),t(f,{label:"活动区域",prop:"region"},{default:o(()=>[t(Y,{modelValue:i(l).region,"onUpdate:modelValue":a[1]||(a[1]=d=>i(l).region=d),placeholder:"请选择活动区域"},{default:o(()=>[t(x,{label:"区域一",value:"shanghai"}),t(x,{label:"区域二",value:"beijing"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"活动时间",required:""},{default:o(()=>[t(M,{span:11},{default:o(()=>[t(f,{prop:"beginDate"},{default:o(()=>[t(j,{placeholder:"开始时间",modelValue:i(l).beginDate,"onUpdate:modelValue":a[2]||(a[2]=d=>i(l).beginDate=d),type:"date","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(M,{span:2,style:{"text-align":"center"}},{default:o(()=>[_("-")]),_:1}),t(M,{span:11},{default:o(()=>[t(f,{prop:"endDate"},{default:o(()=>[t(j,{placeholder:"结束时间",modelValue:i(l).endDate,"onUpdate:modelValue":a[3]||(a[3]=d=>i(l).endDate=d),type:"date","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(f,{label:"即时配送"},{default:o(()=>[t(S,{modelValue:i(l).jit,"onUpdate:modelValue":a[4]||(a[4]=d=>i(l).jit=d),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),t(f,{label:"活动性质",prop:"type"},{default:o(()=>[t(T,{modelValue:i(l).type,"onUpdate:modelValue":a[5]||(a[5]=d=>i(l).type=d)},{default:o(()=>[t(v,{value:1,name:"type"},{default:o(()=>[_("美食/餐厅线上活动")]),_:1}),t(v,{value:2,name:"type"},{default:o(()=>[_("地推活动")]),_:1}),t(v,{value:3,name:"type"},{default:o(()=>[_("线下主题活动")]),_:1}),t(v,{value:4,name:"type"},{default:o(()=>[_("单纯品牌曝光")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"特殊资源",prop:"resource"},{default:o(()=>[t(B,{modelValue:i(l).resource,"onUpdate:modelValue":a[6]||(a[6]=d=>i(l).resource=d)},{default:o(()=>[t(w,{value:1},{default:o(()=>[_("线上品牌商赞助")]),_:1}),t(w,{value:2},{default:o(()=>[_("线下场地免费")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"活动形式",prop:"desc"},{default:o(()=>[t(V,{type:"textarea",modelValue:i(l).desc,"onUpdate:modelValue":a[7]||(a[7]=d=>i(l).desc=d),rows:5},null,8,["modelValue"])]),_:1}),t(f,null,{default:o(()=>[E("div",K,[g.cancelText?(C(),J(h,{key:0,onClick:a[8]||(a[8]=d=>k(i(m)))},{default:o(()=>[_(z(g.cancelText),1)]),_:1})):Z("",!0),t(h,{type:"primary",onClick:a[9]||(a[9]=d=>q(i(m)))},{default:o(()=>[_("提交")]),_:1})])]),_:1})]),_:1},8,["model","rules"])])}}});let b=[{id:1,name:"五一促销活动",region:"shanghai",beginDate:"2024-05-01",endDate:"2024-05-03",jit:1,type:"2,3",resource:2,desc:"活动 1"},{id:2,name:"周末促销活动",region:"beijing",beginDate:"2024-05-04",endDate:"2024-05-05",jit:0,type:"2",resource:1,desc:"活动 2"}];function L(e){return new Promise(n=>{let{pageSize:r,pageNumber:u,orderBy:c}=e;r=r||10,u=u||1;let m=[],l=[],s=[...b];if(c){const[y,k]=c.split(",");s=te(s,y,k)}m=ne(s,e),l=ee(m,r,u),n({status:200,data:{list:l,pageInfo:{total:m.length,pageSize:r,pageNumber:u}}})})}function Q(e){return new Promise(n=>{e.id=new Date().getTime(),b.push(e),n({status:200,data:{success:!0}})})}function W(e){return new Promise(n=>{const r=b.findIndex(u=>u.id===e.id);r>-1&&(b[r]=e),n({status:200,data:{success:!0}})})}function X(e){return new Promise(n=>{for(let r=b.length-1;r>=0;r--){const u=b.findIndex(c=>e.some(m=>c.id===m));u>-1&&b.splice(u,1)}n({status:200,data:{success:!0}})})}function ee(e,n,r){return e.slice((r-1)*n,r*n)}function te(e,n,r){return e.sort((u,c)=>{const m=r==="asc"?[u,c]:[c,u],[l,s]=m.map(k=>k[n]);let y=l-s;return Number.isNaN(y)&&(y=l.localeCompare(s)),y})}function ne(e,n){let{name:r,beginDate:u,endDate:c,jit:m,region:l}=n;return r&&(e=e.filter(s=>s.name.indexOf(r)>-1)),u&&(e=e.filter(s=>s.beginDate.localeCompare(u)>=0)),c&&(e=e.filter(s=>s.endDate.localeCompare(c)<=0)),l&&(e=e.filter(s=>U(l,s.region))),m&&(e=e.filter(s=>U(m,s.jit))),e}function U(e,n){return!e||e.length===0?!0:e.some(r=>r==n)}const le=Object.freeze(Object.defineProperty({__proto__:null,createMarketing:Q,listMarketing:L,removeMarketing:X,updateMarketing:W},Symbol.toStringTag,{value:"Module"})),D=le;function ue(e){return D.listMarketing(e)}function se(e){return D.createMarketing(e)}function de(e){return D.updateMarketing(e)}function me(e){return D.removeMarketing(e)}export{ie as _,se as c,ue as l,ae as p,me as r,de as u};
